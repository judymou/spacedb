{% extends 'layout.html' %}
{% load humanize %}
{% load static %}

{% block scripts %}
<!--
<script src="{% static "js/lib/three.r98.min.js" %}"></script>
<script src="{% static "js/lib/TrackballControls.js" %}"></script>
<script src="{% static "js/lib/spacekit.js" %}"></script>
-->
<script src="http://localhost:8001/src/lib/three.r98.min.js"></script>
<script src="http://localhost:8001/src/lib/TrackballControls.js"></script>
<script src="http://localhost:8001/build/spacekit.js"></script>
<script>
window.EPHEMERIS = [{
  a: {{object.a}},
  e: {{object.e}},
  i: {{object.i}},
  om: {{object.om}},
  w: {{object.w}},
  ma: {{object.ma}},
  epoch: {{object.epoch}}
}];
window.VIZ_OPTS = {
  ecliptic: {
    displayLines: true,
  },
};
</script>
<script src="{% static "js/main.js" %}"></script>
{% endblock %}

{% block content %}
<header class="site-header">
  <h1 class="mainheading">{{object.name}}</h1>
  <h2 class="subheading">
    {% if object.fullname == object.name %}
      {{object.get_size_adjective|capfirst}} {{object.get_orbit_class}}
    {% else %}
      {{object.fullname}}
    {% endif %}
  </h2>
</header>
<div>
  <div class="item-container col-sm-8">
    <div class="item-container__inner">
      <h3>Overview</h3>
      <p>
      {{object.name}} is a {{object.get_size_adjective}} object {{object.get_orbit_desc}}.  NASA JPL has
      {% if object.is_pha and object.is_neo %}
        classified {{object.name}} as a "Potentially Hazardous Object" due to its predicted close pass(es) with Earth.
      {% elif not object.is_pha and object.is_neo %}
        classified {{object.name}} as a "Near Earth Object" due to its proximity to Earth, but is not considered potentially hazardous because simulations have indicated very low likelihood for collision.
      {% elif not object.is_pha and not object.is_neo %}
        does not classify {{object.name}} as potentially hazardous because its orbit does not bring it close to Earth.
      {% endif %}
      </p>

      <p>
      {{object.name}} was discovered in {{object.get_discovery_date|date:"Y"}}.  It orbits the sun every {{object.sbdb_entry.per|floatformat:0|intcomma}} days, coming as close as 0.1 AU and reaching as far as 0.8 AU from the sun.
      {% if object.has_size_info %}
        {{object.name}} is about {{object.sbdb_entry.diameter | floatformat:1}} kilometers in diameter, making it {{object.get_size_rough_comparison}}, comparable in size to {{object.get_diameter_comparison}}.
      {% elif object.has_size_info_estimate %}
        Based on its brightness and the way it reflects light, {{object.name}} is <a href="https://cneos.jpl.nasa.gov/tools/ast_size_est.html">probably</a> between {{object.get_diameter_estimate_low | floatformat:1}} to {{object.get_diameter_estimate_high | floatformat:1}} kilometers in diameter, making it {{object.get_size_rough_comparison}}, very roughly comparable in size to {{object.get_diameter_comparison}}.
      {% endif %}
      </p>

      {% if object.sbdb_entry.rot_per %}
        <p>
        The rotation of {{object.name}} has been observed. It completes a rotation on its axis every {{object.sbdb_entry.rot_per|floatformat:2}} days.
        </p>
      {% endif %}

      {% if object.get_composition %}
        <p>
        {{object.name}}'s spectral type {{object.sbdb_entry.spec_T}} (<a href="http://adsabs.harvard.edu/abs/1989aste.conf..298T">Tholen</a>) / {{object.sbdb_entry.spec_B}} (<a href="http://smass.mit.edu/smass.html">SMASSII</a>) indicates that it is likely to contain
        {% if object.get_composition|length == 1 %}
          {{object.get_composition.0}}.
        {% elif object.get_composition|length == 2 %}
          {{object.get_composition.0}} and {{object.get_composition.1}}.
        {% else %}
          {% for material in object.get_composition %}
            {% if forloop.last %}
              and {{material}}.
            {% else %}
              {{material}},
            {% endif %}
          {% endfor %}
        {% endif %}
        </p>
      {% endif %}

      <h3>Close Approaches</h3>
      <p>
      {{object.name}}'s orbit is {{object.get_moid | floatformat:5}} AU from Earth's orbit at its closest point.
      {% if object.get_moid > 0.01 %}
        This means that there is a wide berth between this asteroid and Earth at all times.
      {% else %}
        This means that it has the potential to get fairly close to Earth.
      {% endif %}
      </p>
      {% if object.sbdb_entry.moid_jup < 0.5 %}
        <p>
          The orbit of {{object.name}} brings it close to Jupiter's orbit.
        </p>
      {% endif %}
      <p>
      {% if object.closeapproach_set.all|length < 1 %}
        Orbital simulations conducted by NASA JPL's CNEOS do not show any close approaches to Earth.
      {% else %}
        <p>
          {{object.name}} has {{object.closeapproach_set.all|length}} close approaches predicted in the coming decades:
        </p>
        <ul>
        {% for close_approach in object.closeapproach_set.all|dictsort:"date" %}
          <li>On {{close_approach.date | date}}, {{object.name}} will pass {{close_approach.get_dist_km|floatformat:0|intcomma}} kilometers from Earth, traveling at {{close_approach.v_rel|floatformat:3}} kilometers per second.</li>
        {% endfor %}
        </ul>
      {% endif %}
      {% if object.sentryevent_set.all|length > 0 %}
        <p>
          <a href="https://cneos.jpl.nasa.gov/sentry/details.html#?des={{object.sbdb_entry.pdes}}">NASA Sentry</a> has assessed impact risk for the following very close approach scenarios:
          <ul>
          {% for event in object.sentryevent_set.all|slice:":5"|dictsort:"date" %}
            <li>
              On {{event.date|date}}, {{object.name}} is predicted to pass Earth at a distance of about {{event.dist_km|floatformat:2|intcomma}} (Â±{{event.dist_err|floatformat:2|intcomma}}) kilometers.  Its probability of impact is {{event.get_prob_percentage|floatformat:8}}%.  Its impact would release {{event.get_energy_with_units}} of energy.
            </li>
          {% endfor %}
          </ul>
        </p>
      {% endif %}
      </p>
      <h3>Images and Observations</h3>
      {{object.name}} was first observed on {{object.get_discovery_date | date}}.  It was last officially observed on {{object.get_lastobs_date | date}}.  The IAU Minor Planet Center records {{object.sbdb_entry.n_obs_used|intcomma}} observations used to determine its orbit.
      <h3>Accessibility and Exploration</h3>
      This object is not considered accessible by the <a href="https://cneos.jpl.nasa.gov/nhats/details.html#?des=2000%20SG344&dv=6&dur=360&stay=8&launch=2015-2040">NHATS study</a>.
      <h3>Similar Objects</h3>
      These asteroids have orbits that share similar characteristic to the orbit of {{object.name}}:
      <ul>
      {% for similar in object.get_similar_orbits %}
        <li>
          <a rel="nofollow" href="/asteroid/{{similar.slug}}">{{similar.fullname}}</a>
        </li>
      {% endfor %}
      </ul>
      <h3>References</h3>
      <ul>
        <li><a rel="nofollow" href="https://ssd.jpl.nasa.gov/sbdb.cgi?sstr={{object.sbdb_entry.pdes}}">JPL Small Body Database</a></li>
        <li><a rel="nofollow" href="https://in-the-sky.org/findercharts.php?objtxt=A{{object.sbdb_entry.pdes}}&duration=5">Sky Finder Chart</a></li>
      </ul>
    </div>
  </div>
  <div class="item-container item-container__rightside col-sm-4">
    <div class="item-container__inner">
      <h3>Key Facts</h3>
      <ul class="keyfacts">
        <li>Classified as a {{object.get_orbit_class}}</li>
        {% if object.is_neo %}
        <li>Classified as a Near Earth Object (NEO)</li>
        {% else %}
        <li>Not a Near Earth Object (NEO)</li>
        {% endif %}
        {% if object.is_pha %}
        <li>Classified as a Potentially Hazardous Object (PHA)</li>
        {% else %}
        <li>Not a Potentially Hazardous Object (PHA)</li>
        {% endif %}
        {% if object.has_size_info %}
          <li>Comparable in size to {{object.get_diameter_comparison}} ({{object.sbdb_entry.diameter | floatformat:2}} km diameter)</li>
        {% elif object.has_size_info_estimate %}
            <li>Comparable in size to {{object.get_diameter_comparison}}</li>
        {% endif %}
        {% if object.closeapproach_set.all|length %}
          {% with approach=object.closeapproach_set.all.0 %}
            <li>Will pass within {{approach.get_dist_km|floatformat:0|intcomma}} km of Earth in {{approach.date|date:"Y"}}</li>
          {% endwith %}
        {% endif %}
      </ul>
    </div>
  </div>
  <div class="item-container item-container__rightside col-sm-4">
    <div class="item-container__inner">
      <h3>Orbital Elements</h3>
      <ul class="keyfacts">
        <li>Epoch: {{object.epoch}} JD</li>
        <li>Semi-major axis: {{object.a | floatformat:5}}</li>
        <li>Eccentricity: {{object.e | floatformat:5}}</li>
        <li>Inclination: {{object.i | floatformat:5}}</li>
        <li>Longitude of Ascending Node: {{object.om | floatformat:5}}</li>
        <li>Argument of Periapsis: {{object.w | floatformat:5}}</li>
        <li>Mean Anomaly: {{object.ma | floatformat:5}}</li>
      </ul>
    </div>
  </div>
  <div class="item-container item-container__rightside col-sm-4">
    <div class="item-container__inner">
      <h3>Physical Characteristics</h3>
      <ul class="keyfacts">
        {% if object.sbdb_entry.diameter %}
          <li>Diameter: {{object.sbdb_entry.diameter}} km</li>
        {% endif %}
        <li>Magnitude: {{object.sbdb_entry.H}}</li>
        {% if object.sbdb_entry.albedo %}
          <li>Albedo: {{object.sbdb_entry.albedo}}</li>
        {% endif %}
        {% if object.sbdb_entry.spec_T %}
          <li>Spectral type (Tholen): {{object.sbdb_entry.spec_T}}</li>
        {% endif %}
        {% if object.sbdb_entry.spec_B %}
          <li>Spectral type (SMASS): {{object.sbdb_entry.spec_B}}</li>
        {% endif %}
      </ul>
    </div>
  </div>
  <div class="item-container item-container__rightside col-sm-4">
    <div class="item-container__inner">
      <h3>Search</h3>
      <div class="react-search"></div>
      &nbsp;&nbsp; or view a <a href="/asteroid/random">random</a> asteroid
    </div>
  </div>
  <div class="item-container col-sm-12">
    <div class="item-container__inner">
      <h3>Orbital Simulation</h3>
      <div id="vis-container"></div>
    </div>
  </div>
</div>
{% endblock %}
